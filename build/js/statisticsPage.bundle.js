(()=>{"use strict";function e(e,t){const i=e.length;for(let s=0;s<i;++s)t(e[s],s)}function t(e,t){let i=!1,s=0;for(;;){if(s=e.indexOf(t,s),-1===s)return i;i=!0,e.splice(s,1)}}function i(e,t){let i=e.indexOf(t);return-1!==i&&(e.splice(i,1),!0)}class s{constructor(){Object.defineProperty(this,"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._disposed=!1}isDisposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._dispose())}}class n{constructor(e){Object.defineProperty(this,"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_dispose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._disposed=!1,this._dispose=e}isDisposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._dispose())}}class a extends s{constructor(e){super(),Object.defineProperty(this,"_disposers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._disposers=e}_dispose(){e(this._disposers,(e=>{e.dispose()}))}get disposers(){return this._disposers}}class r{constructor(){Object.defineProperty(this,"_listeners",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_killed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_disabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_iterating",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_enabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._listeners=[],this._killed=[],this._disabled={},this._iterating=0,this._enabled=!0,this._disposed=!1}isDisposed(){return this._disposed}dispose(){if(!this._disposed){this._disposed=!0;const t=this._listeners;this._iterating=1,this._listeners=null,this._disabled=null;try{e(t,(e=>{e.disposer.dispose()}))}finally{this._killed=null,this._iterating=null}}}hasListeners(){return 0!==this._listeners.length}hasListenersByType(e){return function(t,i){const s=t.length;for(let i=0;i<s;++i)if((null===(n=t[i]).type||n.type===e)&&!n.killed)return!0;var n;return!1}(this._listeners)}enable(){this._enabled=!0}disable(){this._enabled=!1}enableType(e){delete this._disabled[e]}disableType(e,t=1/0){this._disabled[e]=t}_removeListener(e){if(0===this._iterating){const t=this._listeners.indexOf(e);if(-1===t)throw new Error("Invalid state: could not remove listener");this._listeners.splice(t,1)}else this._killed.push(e)}_removeExistingListener(e,t,i,s){if(this._disposed)throw new Error("EventDispatcher is disposed");this._eachListener((n=>{n.once!==e||n.type!==t||void 0!==i&&n.callback!==i||n.context!==s||n.disposer.dispose()}))}isEnabled(e){if(this._disposed)throw new Error("EventDispatcher is disposed");return this._enabled&&this._listeners.length>0&&this.hasListenersByType(e)&&void 0===this._disabled[e]}removeType(e){if(this._disposed)throw new Error("EventDispatcher is disposed");this._eachListener((t=>{t.type===e&&t.disposer.dispose()}))}has(e,t,i){return-1!==function(e,t){const i=e.length;for(let s=0;s<i;++s)if(t(e[s],s))return s;return-1}(this._listeners,(s=>!0!==s.once&&s.type===e&&(void 0===t||s.callback===t)&&s.context===i))}_shouldDispatch(e){if(this._disposed)throw new Error("EventDispatcher is disposed");const t=this._disabled[e];return"number"==typeof(i=t)&&Number(i)==i?(t<=1?delete this._disabled[e]:--this._disabled[e],!1):this._enabled;var i}_eachListener(t){++this._iterating;try{e(this._listeners,t)}finally{--this._iterating,0===this._iterating&&0!==this._killed.length&&(e(this._killed,(e=>{this._removeListener(e)})),this._killed.length=0)}}dispatch(e,t){this._shouldDispatch(e)&&this._eachListener((i=>{i.killed||null!==i.type&&i.type!==e||i.dispatch(e,t)}))}_on(e,t,i,s,a,r){if(this._disposed)throw new Error("EventDispatcher is disposed");this._removeExistingListener(e,t,i,s);const l={type:t,callback:i,context:s,shouldClone:a,dispatch:r,killed:!1,once:e,disposer:new n((()=>{l.killed=!0,this._removeListener(l)}))};return this._listeners.push(l),l}onAll(e,t,i=!0){return this._on(!1,null,e,t,i,((i,s)=>e.call(t,s))).disposer}on(e,t,i,s=!0){return this._on(!1,e,t,i,s,((e,s)=>t.call(i,s))).disposer}once(e,t,i,s=!0){const n=this._on(!0,e,t,i,s,((e,s)=>{n.disposer.dispose(),t.call(i,s)}));return n.disposer}off(e,t,i){this._removeExistingListener(!1,e,t,i)}copyFrom(t){if(this._disposed)throw new Error("EventDispatcher is disposed");if(t===this)throw new Error("Cannot copyFrom the same TargetedEventDispatcher");const i=[];return e(t._listeners,(e=>{!e.killed&&e.shouldClone&&(null===e.type?i.push(this.onAll(e.callback,e.context)):e.once?i.push(this.once(e.type,e.callback,e.context)):i.push(this.on(e.type,e.callback,e.context)))})),new a(i)}}function l(e){return Object.keys(e)}function o(e,t){l(e).forEach((i=>{t(i,e[i])}))}class c{constructor(e,t,i){Object.defineProperty(this,"_settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._name=e,this._template=t,this._settings=i}get(e,t){const i=this._settings[e];return void 0!==i?i:t}set(e,t){this._settings[e]=t,this._template._stateChanged(this._name)}remove(e){delete this._settings[e],this._template._stateChanged(this._name)}setAll(e){l(e).forEach((t=>{this._settings[t]=e[t]})),this._template._stateChanged(this._name)}_apply(e,t){o(this._settings,((i,s)=>{t[i]||e._userSettings[i]||(t[i]=!0,e.setRaw(i,s))}))}}class d{constructor(e){Object.defineProperty(this,"_template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_states",{enumerable:!0,configurable:!0,writable:!0,value:{}}),this._template=e}lookup(e){return this._states[e]}create(e,t){const i=this._states[e];if(i)return i.setAll(t),i;{const i=new c(e,this._template,t);return this._states[e]=i,this._template._stateChanged(e),i}}remove(e){delete this._states[e],this._template._stateChanged(e)}_apply(e,t){o(this._states,((i,s)=>{let n=t.states[i];null==n&&(n=t.states[i]={});const a=e.states.create(i,{});s._apply(a,n)}))}}class u{constructor(){Object.defineProperty(this,"_callbacks",{enumerable:!0,configurable:!0,writable:!0,value:{}})}add(e,t){let s=this._callbacks[e];return void 0===s&&(s=this._callbacks[e]=[]),s.push(t),new n((()=>{i(s,t),0===s.length&&delete this._callbacks[e]}))}remove(e){void 0!==this._callbacks[e]&&delete this._callbacks[e]}_apply(t){const i=[];return o(this._callbacks,((s,n)=>{e(n,(e=>{i.push(t.adapters.add(s,e))}))})),new a(i)}}class h{constructor(e,t){if(Object.defineProperty(this,"_settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_privateSettings",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_settingEvents",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_privateSettingEvents",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_entities",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"states",{enumerable:!0,configurable:!0,writable:!0,value:new d(this)}),Object.defineProperty(this,"adapters",{enumerable:!0,configurable:!0,writable:!0,value:new u}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:new r}),Object.defineProperty(this,"setup",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!t)throw new Error("You cannot use `new Class()`, instead use `Class.new()`");this._settings=e}static new(e){return new h(e,!0)}get entities(){return this._entities}get(e,t){const i=this._settings[e];return void 0!==i?i:t}setRaw(e,t){this._settings[e]=t}set(e,t){this._settings[e]!==t&&(this.setRaw(e,t),this._entities.forEach((i=>{i._setTemplateProperty(this,e,t)})))}remove(e){e in this._settings&&(delete this._settings[e],this._entities.forEach((t=>{t._removeTemplateProperty(e)})))}removeAll(){o(this._settings,((e,t)=>{this.remove(e)}))}getPrivate(e,t){const i=this._privateSettings[e];return void 0!==i?i:t}setPrivateRaw(e,t){return this._privateSettings[e]=t,t}setPrivate(e,t){return this._privateSettings[e]!==t&&(this.setPrivateRaw(e,t),this._entities.forEach((i=>{i._setTemplatePrivateProperty(this,e,t)}))),t}removePrivate(e){e in this._privateSettings&&(delete this._privateSettings[e],this._entities.forEach((t=>{t._removeTemplatePrivateProperty(e)})))}setAll(e){o(e,((e,t)=>{this.set(e,t)}))}on(e,t){let s=this._settingEvents[e];return void 0===s&&(s=this._settingEvents[e]=[]),s.push(t),new n((()=>{i(s,t),0===s.length&&delete this._settingEvents[e]}))}onPrivate(e,t){let s=this._privateSettingEvents[e];return void 0===s&&(s=this._privateSettingEvents[e]=[]),s.push(t),new n((()=>{i(s,t),0===s.length&&delete this._privateSettingEvents[e]}))}_apply(t,i){const s=[];return o(this._settingEvents,((i,n)=>{e(n,(e=>{s.push(t.on(i,e))}))})),o(this._privateSettingEvents,((i,n)=>{e(n,(e=>{s.push(t.onPrivate(i,e))}))})),this.states._apply(t,i),s.push(this.adapters._apply(t)),s.push(t.events.copyFrom(this.events)),new a(s)}_setObjectTemplate(e){this._entities.push(e)}_removeObjectTemplate(e){t(this._entities,e)}_stateChanged(e){this._entities.forEach((t=>{t._applyStateByKey(e)}))}}function p(e,t){return e===t?0:e<t?-1:1}class m{constructor(e,t){if(Object.defineProperty(this,"_root",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_rules",{enumerable:!0,configurable:!0,writable:!0,value:{}}),this._root=e,!t)throw new Error("You cannot use `new Class()`, instead use `Class.new()`")}static new(e){const t=new this(e,!0);return t.setupDefaultRules(),t}setupDefaultRules(){}_lookupRules(e){return this._rules[e]}ruleRaw(e,t=[]){let i=this._rules[e];i||(i=this._rules[e]=[]),t.sort(p);const{index:s,found:n}=function(e,t){let i=0,s=e.length,n=!1;for(;i<s;){const a=i+s>>1,r=t(e[a]);r<0?i=a+1:0===r?(n=!0,i=a+1):s=a}return{found:n,index:n?i-1:i}}(i,(e=>{const i=p(e.tags.length,t.length);return 0===i?function(e,t,i){const s=e.length,n=t.length,a=Math.min(s,n);for(let s=0;s<a;++s){const n=i(e[s],t[s]);if(0!==n)return n}return p(s,n)}(e.tags,t,p):i}));if(n)return i[s].template;{const e=h.new({});return i.splice(s,0,{tags:t,template:e}),e}}rule(e,t=[]){return this.ruleRaw(e,t)}}class g{constructor(e){Object.defineProperty(this,"_value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._value=e}get value(){return this._value/100}get percent(){return this._value}toString(){return this._value+"%"}interpolate(e,t){return e+this.value*(t-e)}static normalize(e,t,i){return e instanceof g?e:new g(t===i?0:100*Math.min(Math.max(1/(i-t)*(e-t),0),1))}}function b(e){return new g(e)}b(0);const _=b(100);b(50);class v extends m{constructor(e,t){super(e,t),Object.defineProperty(this,"_dp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"responsiveRules",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this._dp=new a([this._root._rootContainer.onPrivate("width",(e=>{this._isUsed()&&this._maybeApplyRules()})),this._root._rootContainer.onPrivate("height",(e=>{this._isUsed()&&this._maybeApplyRules()}))])}static widthXXS(e,t){return e<=v.XXS}static widthXS(e,t){return e<=v.XS}static widthS(e,t){return e<=v.S}static widthM(e,t){return e<=v.M}static widthL(e,t){return e<=v.L}static widthXL(e,t){return e<=v.XL}static widthXXL(e,t){return e<=v.XXL}static heightXXS(e,t){return t<=v.XXS}static heightXS(e,t){return t<=v.XS}static heightS(e,t){return t<=v.S}static heightM(e,t){return t<=v.M}static heightL(e,t){return t<=v.L}static heightXL(e,t){return t<=v.XL}static heightXXL(e,t){return t<=v.XXL}static isXXS(e,t){return e<=v.XXS&&t<=v.XXS}static isXS(e,t){return e<=v.XS&&t<=v.XS}static isS(e,t){return e<=v.S&&t<=v.S}static isM(e,t){return e<=v.M&&t<=v.M}static isL(e,t){return e<=v.L&&t<=v.L}static isXL(e,t){return e<=v.XL&&t<=v.XL}static isXXL(e,t){return e<=v.XXL&&t<=v.XXL}static maybeXXS(e,t){return e<=v.XXS||t<=v.XXS}static maybeXS(e,t){return e<=v.XS||t<=v.XS}static maybeS(e,t){return e<=v.S||t<=v.S}static maybeM(e,t){return e<=v.M||t<=v.M}static maybeL(e,t){return e<=v.L||t<=v.L}static maybeXL(e,t){return e<=v.XL||t<=v.XL}static maybeXXL(e,t){return e<=v.XXL||t<=v.XXL}static newEmpty(e){return new this(e,!0)}addRule(e){return e.name&&!e.template&&(e.template=this.rule(e.name,e.tags)),this.responsiveRules.push(e),this._maybeApplyRule(e),e}removeRule(e){t(this.responsiveRules,e)}dispose(){this._dp&&this._dp.dispose()}_isUsed(){return-1!==this._root._rootContainer.get("themes").indexOf(this)}_maybeApplyRules(){e(this.responsiveRules,(e=>{this._maybeUnapplyRule(e)})),e(this.responsiveRules,(e=>{this._maybeApplyRule(e)}))}_maybeApplyRule(e){if(e.applied)return;const t=this._root._rootContainer.getPrivate("width"),i=this._root._rootContainer.getPrivate("height");e.relevant.call(e,t,i)&&(e.applied=!0,e.template&&e.settings&&e.template.setAll(e.settings),e.applying&&e.applying.call(e))}_maybeUnapplyRule(e){if(!e.applied)return;const t=this._root._rootContainer.getPrivate("width"),i=this._root._rootContainer.getPrivate("height");e.relevant.call(e,t,i)||(e.applied=!1,e.template&&e.template.removeAll(),e.removing&&e.removing.call(e))}setupDefaultRules(){super.setupDefaultRules();const e=e=>this.addRule(e);e({name:"Chart",relevant:v.widthXXS,settings:{paddingLeft:0,paddingRight:0}}),e({name:"Chart",relevant:v.heightXXS,settings:{paddingTop:0,paddingBottom:0}}),e({name:"Bullet",relevant:v.isXS,settings:{forceHidden:!0}}),e({name:"Legend",relevant:v.isXS,settings:{forceHidden:!0}}),e({name:"HeatLegend",tags:["vertical"],relevant:v.widthXS,settings:{forceHidden:!0}}),e({name:"HeatLegend",tags:["horizontal"],relevant:v.heightXS,settings:{forceHidden:!0}}),e({name:"Label",tags:["heatlegend","start"],relevant:v.maybeXS,settings:{forceHidden:!0}}),e({name:"Label",tags:["heatlegend","end"],relevant:v.maybeXS,settings:{forceHidden:!0}}),e({name:"Button",tags:["resize"],relevant:v.maybeXS,settings:{forceHidden:!0}}),e({name:"AxisRendererX",relevant:v.heightXS,settings:{inside:!0}}),e({name:"AxisRendererY",relevant:v.widthXS,settings:{inside:!0}}),e({name:"AxisRendererXLabel",relevant:v.heightXS,settings:{minPosition:.1,maxPosition:.9}}),e({name:"AxisLabel",tags:["y"],relevant:v.widthXS,settings:{centerY:_,maxPosition:.9}}),e({name:"AxisLabel",tags:["x"],relevant:v.heightXXS,settings:{forceHidden:!0}}),e({name:"AxisLabel",tags:["x","minor"],relevant:v.widthXXL,settings:{forceHidden:!0}}),e({name:"AxisLabel",tags:["y"],relevant:v.widthXXS,settings:{forceHidden:!0}}),e({name:"AxisLabel",tags:["y","minor"],relevant:v.heightXXL,settings:{forceHidden:!0}}),e({name:"AxisTick",tags:["x"],relevant:v.heightXS,settings:{inside:!0,minPosition:.1,maxPosition:.9}}),e({name:"AxisTick",tags:["y"],relevant:v.widthXXS,settings:{inside:!0,minPosition:.1,maxPosition:.9}}),e({name:"Grid",relevant:v.maybeXXS,settings:{forceHidden:!0}}),e({name:"RadialLabel",tags:["radial"],relevant:v.maybeXS,settings:{forceHidden:!0}}),e({name:"RadialLabel",tags:["circular"],relevant:v.maybeS,settings:{inside:!0}}),e({name:"AxisTick",relevant:v.maybeS,settings:{inside:!0}}),e({name:"RadialLabel",tags:["circular"],relevant:v.maybeXS,settings:{forceHidden:!0}}),e({name:"AxisTick",tags:["circular"],relevant:v.maybeXS,settings:{inside:!0}}),e({name:"PieChart",relevant:v.maybeXS,settings:{radius:b(99)}}),e({name:"PieChart",relevant:v.widthM,settings:{radius:b(99)}}),e({name:"RadialLabel",tags:["pie"],relevant:v.maybeXS,settings:{forceHidden:!0}}),e({name:"RadialLabel",tags:["pie"],relevant:v.widthM,settings:{forceHidden:!0}}),e({name:"Tick",tags:["pie"],relevant:v.maybeXS,settings:{forceHidden:!0}}),e({name:"Tick",tags:["pie"],relevant:v.widthM,settings:{forceHidden:!0}}),e({name:"FunnelSeries",relevant:v.widthM,settings:{alignLabels:!1}}),e({name:"Label",tags:["funnel","vertical"],relevant:v.widthL,settings:{forceHidden:!0}}),e({name:"Tick",tags:["funnel","vertical"],relevant:v.widthL,settings:{forceHidden:!0}}),e({name:"Label",tags:["funnel","horizontal"],relevant:v.heightS,settings:{forceHidden:!0}}),e({name:"Tick",tags:["funnel","horizontal"],relevant:v.heightS,settings:{forceHidden:!0}}),e({name:"PyramidSeries",relevant:v.widthM,settings:{alignLabels:!1}}),e({name:"Label",tags:["pyramid","vertical"],relevant:v.widthL,settings:{forceHidden:!0}}),e({name:"Tick",tags:["pyramid","vertical"],relevant:v.widthL,settings:{forceHidden:!0}}),e({name:"Label",tags:["pyramid","horizontal"],relevant:v.heightS,settings:{forceHidden:!0}}),e({name:"Tick",tags:["pyramid","horizontal"],relevant:v.heightS,settings:{forceHidden:!0}}),e({name:"PictorialStackedSeries",relevant:v.widthM,settings:{alignLabels:!1}}),e({name:"Label",tags:["pictorial","vertical"],relevant:v.widthL,settings:{forceHidden:!0}}),e({name:"Tick",tags:["pictorial","vertical"],relevant:v.widthL,settings:{forceHidden:!0}}),e({name:"Label",tags:["pictorial","horizontal"],relevant:v.heightS,settings:{forceHidden:!0}}),e({name:"Tick",tags:["pictorial","horizontal"],relevant:v.heightS,settings:{forceHidden:!0}}),e({name:"Label",tags:["flow","horizontal"],relevant:v.widthS,settings:{forceHidden:!0}}),e({name:"Label",tags:["flow","vertical"],relevant:v.heightS,settings:{forceHidden:!0}}),e({name:"Chord",relevant:v.maybeXS,settings:{radius:b(99)}}),e({name:"Label",tags:["hierarchy","node"],relevant:v.maybeXS,settings:{forceHidden:!0}})}}Object.defineProperty(v,"XXS",{enumerable:!0,configurable:!0,writable:!0,value:100}),Object.defineProperty(v,"XS",{enumerable:!0,configurable:!0,writable:!0,value:200}),Object.defineProperty(v,"S",{enumerable:!0,configurable:!0,writable:!0,value:300}),Object.defineProperty(v,"M",{enumerable:!0,configurable:!0,writable:!0,value:400}),Object.defineProperty(v,"L",{enumerable:!0,configurable:!0,writable:!0,value:600}),Object.defineProperty(v,"XL",{enumerable:!0,configurable:!0,writable:!0,value:800}),Object.defineProperty(v,"XXL",{enumerable:!0,configurable:!0,writable:!0,value:1e3});const f=v;let y=[],w=null,x=null,S=[],X=[],L=null,A=null,P=[],D=[],k=null,j=[],C=[],O=document.querySelector(".main-date__value"),R=(new Date).getFullYear()+"-"+("0"+(+(new Date).getMonth()+1)).slice(-2);var E;localStorage.getItem("currentDate")||localStorage.setItem("currentDate",R),O.textContent=(E=localStorage.getItem("currentDate"))?"Все время"==E?E:7==E.length?new Date(E).toLocaleString("default",{month:"long"})+" "+new Date(E).getFullYear():4==E.length?E:void 0:(new Date).toLocaleString("default",{month:"long"})+" "+(new Date).getFullYear();let M=localStorage.getItem("email").replace(".","*"),T=document.querySelector(".balance-dynamics-chart__date-wrapper");T.textContent=(new Date).toLocaleString("ru",{year:"numeric",month:"numeric",day:"numeric"}).split(".").reverse().join("-");let H={};!function(){var e=am5.Root.new("trend-chart");const t=f.new(e);t.addRule({relevant:function(e,t){return e<550},applying:function(){n.set("start",.75)},removing:function(){n.set("start",.5)}}),e.setThemes([am5themes_Animated.new(e),t]);var i=e.container.children.push(am5xy.XYChart.new(e,{panX:!0,wheelX:"panX",wheelY:"zoomX",pinchZoomX:!0,paddingLeft:0,layout:e.verticalLayout}));i.responsive={enabled:!0},i.set("cursor",am5xy.XYCursor.new(e,{behavior:"none"})).lineY.set("visible",!1),i.zoomOutButton.set("forceHidden",!0);var s=am5xy.AxisRendererX.new(e,{pan:"zoom",minGridDistance:10}),n=i.xAxes.push(am5xy.CategoryAxis.new(e,{maxDeviation:.1,categoryField:"date",start:.5,minZoomCount:1,maxZoomCount:6,renderer:s}));n.get("renderer").labels.template.setAll({oversizedBehavior:"wrap",textAlign:"center"}),s.labels.template.setAll({fontSize:"0.8em"});var a=i.yAxes.push(am5xy.ValueAxis.new(e,{renderer:am5xy.AxisRendererY.new(e,{strokeOpacity:.1})})),r=i.series.push(am5xy.ColumnSeries.new(e,{name:"месяцы",xAxis:n,yAxis:a,valueYField:"cost",categoryXField:"date",fill:"rgb(0,128,0)"}));r.columns.template.setAll({tooltipText:"{categoryX}: {valueY}",width:am5.percent(90),tooltipY:0,strokeOpacity:0}),r.columns.template.setAll({templateField:"bg"}),r.bullets.push((function(){return am5.Bullet.new(e,{locationY:1,sprite:am5.Label.new(e,{text:"{valueY}",templateField:"bulletLocation",fill:"black",centerX:am5.percent(50),populateText:!0})})})),H={chart:i,series:r,xAxis:n,yAxis:a}}();let Y={};function q(e,t,i,s){var n,a,r=function(e){const t=e.reduce(((e,t)=>{const i=t.date;return e[i]||(e[i]={}),e[i].cost?e[i].cost+=t.cost:e[i].cost=t.cost,e[i].date=t.date,e}),{});return Object.values(t)}(function(e){const t=["январь","февраль","март","апрель","май","июнь","июль","август","сентябрь","октябрь","ноябрь","декабрь"];return e.map((e=>{const i=e.date.split("-"),s=t[parseInt(i[1])-1],n=i[0];return{...e,date:`${s}, ${n}`}}))}(I(e,"increase")));j=function(e){let t=[];for(let i of e)i.cost>=0?t.push({...i,bg:{fill:"#31a51f"},bulletLocation:{centerY:am5.p100}}):t.push({...i,bg:{fill:"red"},bulletLocation:{centerY:am5.p0}});return t}((n=function(){const e=new Date,t=e.getMonth(),i=e.getFullYear();let s=[];for(let e=0;e<12;e++){let n=t-e,a=i;n<0&&(n+=12,a-=1);const r=new Date(a,n,1).toLocaleString("ru",{month:"long"});s.push(`${r}, ${a}`)}return s.map((e=>({cost:0,date:e})))}(),a=r,n.concat(a).reduce(((e,t)=>{const i=e.findIndex((e=>e.date===t.date));return-1===i?e.push(t):e[i].cost+=t.cost,e}),[]).reverse())),t.data.setAll(j),i.data.setAll(j),i.appear(),s.appear(1e3,100)}function B(e,t,i,s,n){C=Z(U(e),n),t.data.setAll(V(Z(U(e),n))),i.data.setAll(V(Z(U(e),n))),i.appear(1e3),s.appear(1e3,100);let a=I(C,"decrease")[0].date,r=C.find((e=>e.date==a)).cost,l=I(C,"increase")[0].cost,o=I(C,"increase")[0].date,c=Math.floor((new Date(a).getTime()-new Date(o).getTime())/864e5);document.querySelector(".balance-dynamics-chart__total-num").textContent=r,document.querySelector(".balance-dynamics-chart__percent").textContent=G(l,r),document.querySelector(".balance-dynamics-chart__percent-name").textContent=N(c)}function z(e){return fetch(`https://database-fc7b1-default-rtdb.europe-west1.firebasedatabase.app/users/${M}/${e}.json`)}function I(e,t){return"decrease"==t?e.sort(((e,t)=>new Date(t.date)-new Date(e.date))):"increase"==t?e.sort(((e,t)=>new Date(e.date)-new Date(t.date))):void 0}function F(e){let t=[];for(let i of e)t.push({...i,cost:Math.abs(i.cost)});return t}function $(){let e=document.querySelector(".select-time").querySelector(".select__input-hidden").value,t=j.slice(j.length-+e),i=function(e){let t=e.reduce(((e,t)=>e+t.cost),0);return`${Math.floor(t/e.length)}`}(t),s=(o=t[0].cost,c=t[t.length-1].cost,o>=c?Math.floor(o/c*100-100)+"%":o<c?Math.abs(Math.floor(c/o*100-100))+"%":void 0),n=function(e,t,i){return e>=t?Math.floor((e/t*100-100)/i.length)+"%":e<t?Math.abs(Math.floor((t/e*100-100)/i.length))+"%":void 0}(t[0].cost,t[t.length-1].cost,t),a=document.querySelector(".trend-card__value_average"),r=document.querySelector(".trend-card__value_whole-difference"),l=document.querySelector(".trend-card__value_month-difference");var o,c;function d(e,t){"Infinity%"==e||"-Infinity%"==e||"NaN%"==e?(t.textContent="Н/д",t.style.color="black"):("0"==e?t.style.color="black":e.includes("-")?t.style.color="red":e.includes("-")||(t.style.color="#31a51f"),t.textContent=e)}d(i,a),d(s,r),d(n,l)}function U(e){let t=[...function(e){const t=[],i=new Date;for(let e=0;e<24;e++){const s=new Date(i.getTime());s.setMonth(i.getMonth()-e);const n=new Date(s.getFullYear(),s.getMonth()+1,0).getDate();for(let e=0;e<n;e++){let i;s.getMonth(),(new Date).getMonth(),i=new Date(s.getFullYear(),s.getMonth(),e+1);const n=new Date(i).toLocaleString("ru",{month:"numeric",day:"numeric",year:"numeric"});t.push(n.split(".").reverse().join("-"))}}return I(t.map((e=>({cost:0,date:e}))),"decrease")}().map((t=>{for(let i of e)i.date==t.date&&(t.cost+=i.cost);return t}))].reverse();return function(e){let i=0;for(let s=0;s<e.length;s++)0===e[s].cost?e[s].cost=i:(e[s-1]&&(e[s].cost=t[s-1].cost+e[s].cost),i=e[s].cost);return e}(t)}function V(e){for(let t of e)t.date=Date.parse(t.date);return e}function G(e,t){return 0==e||0==t?"Н/д":e>=t&&e<=0?-Math.floor(t/e*100-100)+"%":e>=t?Math.floor(t/e*100-100)+"%":e<t?Math.abs(Math.floor(t/e*100-100))+"%":void 0}function N(e){return 1==e||(e-11)%10==0&&11!=e?`за ${e} день`:2==e||3==e||4==e?`за ${e} дня`:`за ${e} дней`}function Z(e,t){const i=new Date(e[e.length-1].date).getMonth()-t,s=new Date(new Date(e[e.length-1].date).getFullYear(),i,new Date(e[e.length-1].date).getDate()).toLocaleString("ru",{year:"numeric",month:"numeric",day:"numeric"}).split(".").reverse().join("-");return e.filter((e=>new Date(e.date)>=new Date(s)))}Promise.all([z("categoriesExpenses"),z("categoriesExpensesByDate"),z("categoriesIncome"),z("categoriesIncomeByDate"),z("operationsExpenses"),z("operationsExpensesByDate"),z("operationsIncome"),z("operationsIncomeByDate")]).then((e=>Promise.all([e[0].json(),e[1].json(),e[2].json(),e[3].json(),e[4].json(),e[5].json(),e[6].json(),e[7].json()]))).then((e=>{S=e[0]?e[0]:[],w=e[1]?e[1]:[],P=e[2]?e[2]:[],L=e[3]?e[3]:[],y=e[4]?e[4]:[],x=null!=e[5]?e[5]:[],X=e[6]?e[6]:[],A=null!=e[7]?e[7]:[],D=y&&X?y.concat(X):[],k=S&&P?S.concat(P):[],q(F(y),H.xAxis,H.series,H.chart),$(),function(e){var t=am5.Root.new("balance-dynamics-chart");t.setThemes([am5themes_Animated.new(t)]);var i=t.container.children.push(am5xy.XYChart.new(t,{panX:!1,panY:!1,paddingLeft:0}));i.zoomOutButton.set("forceHidden",!0);var s=am5xy.AxisRendererX.new(t,{minGridDistance:250}),n=i.xAxes.push(am5xy.DateAxis.new(t,{baseInterval:{timeUnit:"day",count:0},renderer:s})),a=am5xy.AxisRendererY.new(t,{}),r=i.yAxes.push(am5xy.ValueAxis.new(t,{renderer:a})),l=i.series.push(am5xy.LineSeries.new(t,{name:"Series",xAxis:n,yAxis:r,valueYField:"cost",valueXField:"date",tooltip:am5.Tooltip.new(t,{labelText:"{valueY}"}),stroke:"rgb(0,128,0)"}));l.fills.template.setAll({visible:!0,fillOpacity:.3}),l.set("fill","rgba(0,128,0, 0.3)");var o=r.makeDataItem({value:0,endValue:-1e7});r.createAxisRange(o);var c=r.makeDataItem({value:0,endValue:-1e5}),d=l.createAxisRange(c);d.fills.template.setAll({visible:!0,opacity:.3}),d.fills.template.set("fill","rgba(255, 0, 0, 0.6)"),d.strokes.template.set("stroke","rgba(255, 0, 0, 1)");var u=new Date;am5.time.add(u,"day",Math.round(l.dataItems.length/2));var h=u.getTime(),p=n.createAxisRange(n.makeDataItem({}));p.set("value",h),p.get("grid").setAll({strokeOpacity:1,stroke:"rgb(195, 195, 208)",strokeWidth:2});var m=am5.Button.new(t,{height:6,width:18,themeTags:["resize","horizontal"]});m.get("background").setAll({cornerRadiusTL:am5.p100,cornerRadiusTR:am5.p100,cornerRadiusBR:am5.p100,cornerRadiusBL:am5.p100,fill:"rgb(195, 195, 208)",fillOpacity:1,stroke:"rgb(195, 195, 208)"}),m.get("background").states.create("down",{}).setAll({fill:"rgb(195, 195, 208)",fillOpacity:1}),m.adapters.add("y",(function(){return 0}));let g=0;m.adapters.add("x",(function(e){return g=Math.max(0,Math.min(i.plotContainer.width(),e)),T.style.left=g+"px",g})),m.events.on("dragged",(function(){var t=m.x(),s=n.toAxisPosition(t/i.plotContainer.width()),a=n.positionToValue(s);p.set("value",a);let r=new Date(a).toLocaleString("ru",{year:"numeric",month:"numeric",day:"numeric"}).split(".").reverse().join("-"),l=e.find((e=>e.date==r)).cost,o=e[0].cost,c=e[0].date,d=Math.floor((new Date(r).getTime()-new Date(c).getTime())/864e5);document.querySelector(".balance-dynamics-chart__total-num").textContent=l,document.querySelector(".balance-dynamics-chart__percent").textContent=G(o,l),document.querySelector(".balance-dynamics-chart__percent-name").textContent=N(d),T.textContent=r,T.style.left=t+10+"px"})),p.set("bullet",am5xy.AxisBullet.new(t,{location:0,sprite:m})),Y={chart:i,series:l,xAxis:n,yAxis:r,resizeButton1:m,range1:p}}(I(Z(U(D),12),"increase")),B(D,Y.xAxis,Y.series,Y.chart,12)})),document.querySelectorAll(".select").forEach((function(e){const t=e.querySelector(".select__button"),i=e.querySelector(".select__dropdown"),s=e.querySelector(".select__dropdown-list"),n=e.querySelectorAll(".select__dropdown-item"),a=e.querySelector(".select__input-hidden");t.addEventListener("click",(function(){s.classList.toggle("select__dropdown-list_visible"),i.classList.toggle("select__dropdown_visible"),this.classList.add("select__button_active")})),n.forEach((e=>{e.addEventListener("click",(function(n){if(n.stopPropagation(),t.querySelector(".select__button-title").textContent=this.textContent,a.value=this.dataset.value,s.classList.remove("select__dropdown-list_visible"),i.classList.remove("select__dropdown_visible"),e.closest(".select-trend")&&("expenses"==a.value?q(F(y),H.xAxis,H.series,H.chart):"income"==a.value?q(X,H.xAxis,H.series,H.chart):"netIncome"==a.value&&q(D,H.xAxis,H.series,H.chart)),$(),e.closest(".select-time-balance")){let e=I(Z(U(D),+a.value),"increase");B(D,Y.xAxis,Y.series,Y.chart,+a.value),Y.range1.set("value",(new Date).getTime()),T.textContent=(new Date).toLocaleString("ru",{year:"numeric",month:"numeric",day:"numeric"}).split(".").reverse().join("-"),Y.resizeButton1.events.on("dragged",(function(){var t=Y.resizeButton1.x(),i=Y.xAxis.toAxisPosition(t/Y.chart.plotContainer.width()),s=Y.xAxis.positionToValue(i);Y.range1.set("value",s);let n=new Date(s).toLocaleString("ru",{year:"numeric",month:"numeric",day:"numeric"}).split(".").reverse().join("-"),a=e.find((e=>e.date==n))?e.find((e=>e.date==n)).cost:0,r=e[0].cost,l=e[0].date,o=Math.floor((new Date(n).getTime()-new Date(l).getTime())/864e5);document.querySelector(".balance-dynamics-chart__total-num").textContent=a,document.querySelector(".balance-dynamics-chart__percent").textContent=G(r,a),document.querySelector(".balance-dynamics-chart__percent-name").textContent=N(o),T.textContent=n,T.style.left=t+10+"px"}))}}))})),document.addEventListener("click",(function(e){e.target!=t&&(s.classList.remove("select__dropdown-list_visible"),i.classList.remove("select__dropdown_visible"))}))})),document.querySelectorAll(".statistics-types__item").forEach((e=>{e.addEventListener("click",(function(){let t=document.querySelector(".statistics-types__item_act");t&&t!=e&&t.classList.remove("statistics-types__item_act"),e.classList.add("statistics-types__item_act");let i=e.dataset.tab,s=document.getElementById(i),n=document.querySelector(".statistics-tabs__tab_act");n&&n!=s&&n.classList.remove("statistics-tabs__tab_act"),s.classList.add("statistics-tabs__tab_act"),Y.series.appear(),Y.chart.appear(1e3,100),H.series.appear(),H.chart.appear(1e3,100)}))}))})();